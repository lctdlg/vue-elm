(function(){"use strict";var t={5656:function(t,e,s){var r=s(6848),o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("SellHeader"),e("MyTab")],1)},n=[],i=function(){var t=this,e=t._self._c;return t.seller?e("div",{staticClass:"header"},[e("div",{staticClass:"content-wrapper",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openDialog.apply(null,arguments)}}},[e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t.seller.avatar,width:"100%",height:"100%",alt:""}})]),e("div",{staticClass:"content"},[e("div",{staticClass:"title"},[e("div",{staticClass:"brand"}),e("div",{staticClass:"name"},[t._v(t._s(t.seller.name))])]),e("div",{staticClass:"description"},[t._v(t._s(`${t.seller.description}/${t.seller.deliveryTime}分钟到达`))]),e("div",{staticClass:"support"},[e("div",{staticClass:"support-icon"}),e("div",{staticClass:"support-text"},[t._v(" "+t._s(t.seller.supports[0].description)+" ")])])]),e("div",{staticClass:"support-count"},[e("span",[t._v(t._s(`${t.seller.supports.length}个`))]),e("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M36 24.0083H12",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M24 12L36 24L24 36",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])])]),e("div",{staticClass:"bulletin-wrapper"},[e("span",{staticClass:"bulletin-title"}),e("span",{staticClass:"bulletin-text"},[t._v(" "+t._s(t.seller.bulletin)+" ")]),e("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M36 24.0083H12",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M24 12L36 24L24 36",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])]),e("div",{staticClass:"background"},[e("img",{attrs:{src:t.seller.avatar,width:"100%",height:"100%",alt:""}})]),t.dialog?e("div",{directives:[{name:"disableBack",rawName:"v-disableBack"}],staticClass:"dialog-wrapper"},[e("div",{staticClass:"dialog-wrapper-detail"},[t._v("1121221")]),e("div",{staticClass:"dialog-wrapper-close"},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeDialog.apply(null,arguments)}}},[e("path",{attrs:{d:"M8 8L40 40",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M8 40L40 8",stroke:"#fff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])])]):t._e()]):t._e()},a=[];const l=()=>()=>{window.removeEventListener("touchstart",(()=>{}))};var c={name:"SellHeader",beforeRouteLeave(t,e,s){this.flag?s(!1):s(!0)},data(){return{flag:!0,cleanBackHandler:null,seller:null,dialog:null}},created(){this.fetchData()},methods:{async fetchData(){try{const t=await fetch("api/seller.json",{method:"GET",headers:{"Content-Type":"application/json"}}),{seller:e,errno:s}=await t.json();0===s&&e&&(this.seller=e)}catch{this.seller=null}},openDialog(){this.cleanBackHandler=l(),this.dialog=!0},closeDialog(){this.cleanBackHandler?.(),this.dialog=!1}}},d=c,u=s(1656),h=(0,u.A)(d,i,a,!1,null,"af053a8a",null),p=h.exports,f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tab-wrapper"},[e("div",{staticClass:"container"},[e("div",{ref:"tab",staticClass:"tab"},[t._l(t.tabs,(function(s,r){return e("div",{key:r,staticClass:"tab-item",on:{click:function(e){return t.switchTab(r)}}},[e("div",[t._v(t._s(s.name))])])})),e("div",{ref:"tab-bar",staticClass:"tab-bar",style:{width:t.tabWidth+"px"}})],2),e("div",{staticClass:"slide-wrapper"},[e("KeepAlive",[e(t.activeComponent,{ref:"component",tag:"Component"})],1)],1)])])},v=[];s(8111),s(116),s(1701);function w(t,e=500){let s;return function(){clearTimeout(s),s=setTimeout((()=>{t()}),e)}}var m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"goods-wrapper"},[e("div",{staticClass:"goods"},[e("EleScroll",{ref:"menus",staticClass:"menu-wrapper",attrs:{data:t.list}},[e("div",{staticClass:"menu-items"},t._l(t.list,(function(s,r){return e("div",{key:r,ref:"menu",refInFor:!0,staticClass:"menu-item",class:[t.currentIndex===r?"active-menu-item":""],on:{click:function(e){return t.selectMenu(r,e)}}},[e("span",[t._v(t._s(s.name))])])})),0)]),e("EleScroll",{ref:"foods",staticClass:"foods-wrapper",attrs:{data:t.list,"listen-scroll":!0},on:{scroll:t.scroll}},[e("div",t._l(t.list,(function(s,r){return e("div",{key:r,ref:"food",refInFor:!0},[e("div",{staticClass:"title"},[t._v(t._s(s.name))]),e("div",{staticClass:"foods-items"},t._l(s.foods,(function(s,o){return e("div",{key:o,staticClass:"foods-item",class:[!1]},[e("div",{staticClass:"icon"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.icon,expression:"food.icon"}],attrs:{width:"57",height:"57",alt:""}})]),e("div",{staticClass:"container"},[e("div",{staticClass:"name"},[t._v(t._s(s.name))]),e("div",{staticClass:"description"},[t._v(t._s(s.description))]),e("div",{staticClass:"extra"},[e("span",[t._v(t._s(`月售${s.sellCount}份`))]),e("span",[t._v(t._s(`好评率${s.rating}%`))])]),e("div",{staticClass:"price"},[e("span",{staticClass:"now"},[t._v(t._s(`￥${s.price}`))]),e("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"old"},[t._v(t._s(`￥${s.oldPrice}`))])]),e("div",{staticClass:"cart-control-wrapper"},[e("ContRol",{attrs:{food:s},on:{increase:e=>{t.increase(r,o,e)},decrease:function(e){return t.decrease(r,o)}}})],1)])])})),0)])})),0)])],1),e("div",{staticClass:"shop-car-wrapper"},[e("ShopCar",{ref:"shopCar",attrs:{"select-foods":t.selectFoods}})],1)])},C=[],b=(s(4114),s(9314),s(7588),function(){var t=this,e=t._self._c;return e("div",{ref:"scroll"},[t._t("default")],2)}),k=[],g=s(3819),_={name:"Elescroll",props:{click:{type:Boolean,default:!0},scrollX:{type:Boolean,default:!1},probeType:{type:Number,default:3},listenScroll:{type:Boolean,default:!1},data:{type:[Object,Array],default:()=>[]}},watch:{data(){setTimeout((()=>{this.refresh()}),20)}},mounted(){this.$nextTick((()=>{this._initScroll()}))},methods:{_initScroll(){if(this.$refs.scroll&&!this.scroll&&(this.scroll=new g.Ay(this.$refs.scroll,{click:this.click,probeType:this.probeType,scrollX:this.scrollX}),this.listenScroll)){const t=this;this.scroll.on("scroll",(e=>{t.$emit("scroll",e)}))}},refresh(){this.scroll&&this.scroll.refresh()},scrollToElement(t,e){this.scroll&&this.scroll.scrollToElement(t,e)}}},y=_,x=(0,u.A)(y,b,k,!1,null,null,null),T=x.exports,j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"shop-car"},[e("div",{staticClass:"container",on:{click:t.toggleList}},[e("div",{staticClass:"container-left"},[e("div",{staticClass:"car-wrapper"},[e("div",{class:["car",t.carClass]},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M39 32H13L8 12H44L39 32Z",fill:"#999"}}),e("path",{attrs:{d:"M3 6H6.5L8 12M8 12L13 32H39L44 12H8Z",stroke:"#999","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("circle",{attrs:{cx:"13",cy:"39",r:"3",stroke:"#999","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("circle",{attrs:{cx:"39",cy:"39",r:"3",stroke:"#999","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])]),e("div",{staticClass:"count-wrapper"},[e("div",{staticClass:"count"},[t._v(t._s(t.count))])])]),e("div",{staticClass:"price"},[t._v("￥"+t._s(t.totalPrice))]),e("div",{staticClass:"desc"},[t._v("另需配送费￥4元")])]),e("div",{staticClass:"container-right",on:{click:t.handlePay}},[e("div",{staticClass:"pay",class:[t.totalPrice>=20?"pay-light":""]},[t._v(t._s(t.payDesc))])])]),e("div",{staticClass:"ball-container"},t._l(t.balls,(function(s,r){return e("div",{key:r},[e("Transition",{on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.show,expression:"ball.show"}],staticClass:"ball"},[e("div",{staticClass:"inner inner-hook"})])])],1)})),0)])},$=[];const L=10;function E(){const t=[];for(let e=0;e<L;e++)t.push({show:!1});return t}var B={name:"ShopCar",props:{selectFoods:{type:Array,default:()=>[]}},data(){return{show:!1,balls:E(),dropBalls:[]}},computed:{totalPrice(){let t=0;return this.selectFoods.forEach((e=>{t+=e.count*e.price})),t},count(){let t=0;return this.selectFoods.forEach((e=>{t+=e.count})),t},payDesc(){return 0===this.totalPrice?"￥20元起送":this.totalPrice<20?`还差￥${20-this.totalPrice}元起送`:"去结算"},carClass(){return this.count?"car-light":""}},methods:{drop(t){for(let e=0;e<this.balls.length;e++){const s=this.balls[e];if(!s.show)return s.show=!0,s.el=t,void this.dropBalls.push(s)}},handlePay(){this.totalPrice>=20&&alert("请先登录")},toggleList(){},beforeEnter(t){const e=this.dropBalls[this.dropBalls.length-1],s=e.el.getBoundingClientRect(),r=s.left-32,o=-(window.innerHeight-s.top-22);t.style.display="",t.style.webkitTransform=`translate3d(0,${o}px,0)`,t.style.transform=`translate3d(0,${o}px,0)`;const n=t.querySelector(".inner-hook");n.style.webkitTransform=`translate3d(${r}px,0,0)`,n.style.transform=`translate3d(${r}px,0,0)`},enter(t,e){this._reflow=document.body.offsetHeight,t.style.webkitTransform="translate3d(0,0,0)",t.style.transform="translate3d(0,0,0)";const s=t.querySelector(".inner-hook");s.style.webkitTransform="translate3d(0,0,0)",s.style.transform="translate3d(0,0,0)",t.addEventListener("transitionend",e)},afterEnter(t){const e=this.dropBalls.shift();e.show=!1,t.style.display="none"}}},A=B,M=(0,u.A)(A,j,$,!1,null,"e048dd56",null),P=M.exports,F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cont-rol"},[e("Transition",{attrs:{name:"move"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.food?.count>0,expression:"food?.count > 0"}],staticClass:"cart-decrease",on:{click:function(e){return e.stopPropagation(),t._decrease.apply(null,arguments)}}},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:"#f01414",stroke:"#f01414","stroke-width":"4","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M16 24L32 24",stroke:"#FFF","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])])]),e("Transition",{attrs:{name:"num"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.food?.count>0,expression:"food?.count > 0"}],staticClass:"cart-count"},[t._v(t._s(t.food.count))])]),e("div",{staticClass:"cart-add",on:{click:t._increase}},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:"#f01414",stroke:"#f01414","stroke-width":"4","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M24 16V32",stroke:"#FFF","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M16 24L32 24",stroke:"#FFF","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}})])])],1)},S=[],H={name:"ContRol",props:{food:{type:Object,default:null}},methods:{beforeEnter(t){},enter(t,e){},afterEnter(){},enterCancelled(){},beforeLeave(){},leave:function(t,e){e()},afterLeave:function(t){},leaveCancelled:function(t){},_increase(t){this.$emit("increase",t.target)},_decrease(){this.$emit("decrease")}}},I=H,O=(0,u.A)(I,F,S,!1,null,"08a5fcf1",null),D=O.exports,N={name:"Goods",components:{EleScroll:T,ContRol:D,ShopCar:P},data(){return{currentIndex:0,list:[],scrollY:0,foodsCalcu:[],meunList:[]}},computed:{selectFoods(){const t=[];return this.list.forEach((e=>{e.foods.forEach((e=>{e.count&&t.push(e)}))})),t}},async mounted(){await this.fetchData(),this.initFoodsCalcu()},activated(){console.log("keep激活了")},deactivated(){console.log("keep离开了")},methods:{scroll(t){this.scrollY=Math.abs(Math.round(t.y)),this.handleContentScroll()},handleContentScroll(){const t=this.foodsCalcu.findIndex(((t,e)=>this.scrollY>=t&&this.scrollY<(this.foodsCalcu[e+1]||1/0)));-1!==t&&t!==this.currentIndex&&(this.currentIndex=t,this.$refs.menus.scrollToElement(this.$refs.menu[t],200))},async fetchData(){try{const t=await fetch("api/goods.json",{method:"GET",headers:{"Content-Type":"application/json"}}),{goods:e,errno:s}=await t.json();0===s&&e&&(this.list=e)}catch(t){this.list=null}},selectMenu(t,e){e._constructed&&(this.currentIndex=t,this.$refs.foods.scrollToElement(this.$refs.food[t],200))},initFoodsCalcu(){this.$nextTick((()=>{const t=this.$refs.food;this.meunList=this.$refs.menu;let e=0;this.foodsCalcu.push(e),t.forEach((t=>{e+=t.clientHeight,this.foodsCalcu.push(e)}))}))},increase(t,e,s){this.list[t]["foods"][e].count?this.list[t]["foods"][e].count++:r.Ay.set(this.list[t]["foods"][e],"count",1),this.$refs.shopCar.drop(s)},decrease(t,e){this.list[t]["foods"][e].count&&this.list[t]["foods"][e].count--}}},z=N,R=(0,u.A)(z,m,C,!1,null,"dd37b34c",null),W=R.exports,X=function(){var t=this,e=t._self._c;return e("div",[t._v("ragings")])},Y=[],Z={},G=(0,u.A)(Z,X,Y,!1,null,null,null),q=G.exports,K=function(){var t=this,e=t._self._c;return e("div",[t._v("seller")])},V=[],J={},Q=(0,u.A)(J,K,V,!1,null,null,null),U=Q.exports,tt={name:"Mytab",props:{tabs:{type:Array,default:()=>[{component:W,name:"商品",id:0},{component:q,name:"评论",id:1},{component:U,name:"商家",id:2}]}},data(){return{currentIndex:0,tabWidth:0,tabPositions:[]}},computed:{activeComponent(){const t=this.tabs.find((t=>t.id===this.currentIndex));return t?t.component:null},currentPosition(){return this.tabPositions[this.currentIndex]||0}},mounted(){this.calculateLayout(),window.addEventListener("resize",w(this.calculateLayout,1500))},beforeDestroy(){window.removeEventListener("resize",w(this.calculateLayout,1500))},methods:{calculateLayout(){const t=this.$refs.tab;t&&(this.tabWidth=t.clientWidth/this.tabs.length,this.tabPositions=this.tabs.map(((t,e)=>this.tabWidth*e)),this.updateTabBar())},updateTabBar(){const t=this.$refs["tab-bar"];t&&(t.style.transform=`translateX(${this.currentPosition}px)`)},switchTab(t){this.currentIndex=t,this.updateTabBar()}}},et=tt,st=(0,u.A)(et,f,v,!1,null,"4be4dd30",null),rt=st.exports,ot={name:"App",components:{SellHeader:p,MyTab:rt}},nt=ot,it=(0,u.A)(nt,o,n,!1,null,null,null),at=it.exports;const lt={inserted:(t,e)=>{const s=e.value;t.setAttribute("data-src",s),t._observer=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const s=e.target;s.src=s.dataset.src,t._observer.unobserve(s)}}))})),t._observer.observe(t)},unbind:t=>{t._observer&&t._observer.disconnect()}},ct={bind(t,e){},unbind(t){}};r.Ay.directive("lazy",lt),r.Ay.directive("disableBack",ct),r.Ay.config.productionTip=!1,new r.Ay({name:"App",render:t=>t(at)}).$mount("#app")}},e={};function s(r){var o=e[r];if(void 0!==o)return o.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,r,o,n){if(!r){var i=1/0;for(d=0;d<t.length;d++){r=t[d][0],o=t[d][1],n=t[d][2];for(var a=!0,l=0;l<r.length;l++)(!1&n||i>=n)&&Object.keys(s.O).every((function(t){return s.O[t](r[l])}))?r.splice(l--,1):(a=!1,n<i&&(i=n));if(a){t.splice(d--,1);var c=o();void 0!==c&&(e=c)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[r,o,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,n,i=r[0],a=r[1],l=r[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(l)var d=l(s)}for(e&&e(r);c<i.length;c++)n=i[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(d)},r=self["webpackChunkvue2_7_project"]=self["webpackChunkvue2_7_project"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],(function(){return s(5656)}));r=s.O(r)})();
//# sourceMappingURL=app.d4fbdf34.js.map